/*!
    photobox v1.9.9
    (c) 2013 Yair Even Or <http://dropthebit.com>

    MIT-style license.
*/
!function(e,t,o){"use strict";function i(e,t){var o=!1;return function(){o||(e.call(),o=!0,setTimeout(function(){o=!1},t))}}function n(){J&&lt.hide(),e(t).on("touchstart.testMouse",function(){e(t).off("touchstart.testMouse"),V=!0,lt.addClass("mobile")}),W.off().on("click",P.toggle),_.off().on("click","a",E.click),Z&&lt.addClass("msie"),lt.off().on("click","img",function(e){e.stopPropagation()}),e(t.body).append(lt),z=t.documentElement}function s(e,t,o){1==t?(X.css({transform:"translateX(25%)",transition:".2s",opacity:0}),setTimeout(function(){S(D)},200)):-1==t&&(X.css({transform:"translateX(-25%)",transition:".2s",opacity:0}),setTimeout(function(){S(O)},200)),1==o?R.prop("checked",!0):-1==o&&R.prop("checked",!1)}function a(e){var o,i=t.createElement("p").style,n=["ms","O","Moz","Webkit"];if(""==i[e])return e;for(e=e.charAt(0).toUpperCase()+e.slice(1),o=n.length;o--;)if(""==i[n[o]+e])return n[o]+e}function r(t){var o=t.keyCode,i=T.keys;return e.inArray(o,i.close)>=0&&A()||e.inArray(o,i.next)>=0&&!T.single&&h(O)||e.inArray(o,i.prev)>=0&&!T.single&&h(D)||!0}function l(e,t,o){1==o?h(O):-1==o&&h(D)}function u(){var e="pbPrevBtn"==this.id?D:O;return h(e),!1}function c(e){M=K,K=e,L=Q[e][0],D=(K||(T.loop?Q.length:0))-1,O=(K+1)%Q.length||(T.loop?0:-1)}function h(e){if(!T.loop){var t=K==Q.length-1&&e==O,o=0==K&&e==D;if(t||o)return}S(e)}function d(){var t=Q[K][0],o=e("<a>").prop("href",Q[K][0])[0].search?"&":"?";return t+=o+"vq=hd720&wmode=opaque",e("<iframe>").prop({scrolling:"no",frameborder:0,allowTransparency:!0,src:t}).attr({webkitAllowFullScreen:!0,mozallowfullscreen:!0,allowFullScreen:!0})}function p(){if(j.off(G).removeClass("change"),T.counter){try{var e=T.counter.replace("A",K+1).replace("B",Q.length)}catch(t){T.counter="(A/B)",p()}Y.find(".counter").text(e)}T.title&&Y.find(".title").html("<span>"+Q[K][1]+"</span>")}function f(){lt.addClass("error"),X[0].src=et,nt.onerror=null}function m(e){function t(){clearTimeout(i),o.off(G).css({transition:"none"}),lt.removeClass("video"),"video"==H?(X[0].src=et,B.addClass("prepare"),lt.addClass("video")):X.prop({src:L,"class":"prepare"}),setTimeout(function(){X.add(B).removeAttr("style").removeClass("prepare"),lt.removeClass("pbHide next prev"),setTimeout(function(){X.add(B).on(G,v),Z&&v()},0)},50)}var o,i;i=setTimeout(t,2e3),q.fadeOut(300,function(){lt.removeClass("pbLoading"),q.removeAttr("style")}),lt.addClass("pbHide"),X.add(B).removeAttr("style").removeClass("zoomable"),e||"video"!=k[M].rel?o=X:(o=B,X.addClass("prepare")),e||Z?t():o.on(G,t)}function v(){X.add(B).off(G).addClass("zoomable"),"video"==H?B.removeClass("pbHide"):W&&T.autoplay&&P.play(),"function"==typeof x.callback&&x.callback.apply(k[K])}function g(o,i,n){if(n)return!1;if("video"==H){var s=B.data("zoom")||1;if(s+=i/10,.5>s)return!1;B.data("zoom",s).css({width:624*s,height:351*s})}else{var s=X.data("zoom")||1,a=X[0].getBoundingClientRect();s+=i/10,.1>s&&(s=.1),it(function(){X.data("zoom",s).css({transform:"scale("+s+")"})}),a.height>z.clientHeight||a.width>z.clientWidth?e(t).on("mousemove.photobox",w):(e(t).off("mousemove.photobox"),X[0].style[tt]="50% 50%")}return!1}function b(e,t){e.preventDefault(),e.stopPropagation();var o,i=x.thumbsList;i.css("height",i[0].clientHeight+10*t),o=Y[0].clientHeight/2,U[0].style.cssText="margin-top: -"+o+"px; padding: "+o+"px 0;",_.hide().show(0)}function w(e){var t=e.clientY/z.clientHeight*(z.clientHeight+200)-100,o=t/z.clientHeight*100,i=e.clientX/z.clientWidth*100,n=i.toFixed(2)+"% "+o.toFixed(2)+"%";it(function(){X[0].style[tt]=n})}function y(){clearTimeout(P.autoPlayTimer),e(t).off("mousemove.photobox"),nt.onload=function(){},nt.src=st.src=at.src=L}function A(){function t(){""!=lt[0].className&&(lt.removeClass("show pbHide error pbLoading"),X.removeAttr("class").removeAttr("style").off().data("zoom",1),Y.find(".title").empty(),J&&setTimeout(function(){lt.hide()},200),T.hideFlash&&e("iframe, object, embed").css("visibility","visible"))}return lt.hasClass("show")?(y(),B.find("iframe").prop("src","").empty(),C.prototype.setup(),ut.clear(),lt.removeClass("on video").addClass("pbHide"),X.on(G,t),Z&&t(),setTimeout(function(){x=null},1e3),setTimeout(t,500),void("function"==typeof T.afterClose&&T.afterClose(lt))):!1}var C,x,T,k,L,M,H,D,O,E,z,P,S,F,X,B,I,N,R,Y,j,q,W,_,U,Q=[],K=-1,G="transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",Z=!("placeholder"in t.createElement("input")),J=function(){var t=e("<p>")[0];return t.style.cssText="pointer-events:auto",!t.style.pointerEvents}(),V=!1,$=e(),et="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",tt=a("transformOrigin"),ot=a("transition"),it=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},nt={},st=new Image,at=new Image,rt={single:!1,beforeShow:null,afterClose:null,loop:!0,thumb:null,thumbs:!0,thumbAttr:"data-src",counter:"(A/B)",title:!0,autoplay:!1,time:3e3,history:!1,hideFlash:!0,zoomable:!0,wheelNextPrev:!0,keys:{close:[27,88,67],prev:[37,80],next:[39,78]}},lt=e('<div id="pbOverlay">').append(R=e('<input type="checkbox" id="pbThumbsToggler" checked hidden>'),q=e('<div class="pbLoader"><b></b><b></b><b></b></div>'),I=e('<div id="pbPrevBtn" class="prevNext"><b></b></div>').on("click",u),N=e('<div id="pbNextBtn" class="prevNext"><b></b></div>').on("click",u),U=e('<div class="pbWrapper">').append(X=e("<img>"),B=e("<div>")),F=e('<div id="pbCloseBtn">').on("click",A)[0],W=e('<div id="pbAutoplayBtn">').append(e('<div class="pbProgress">')),Y=e('<div id="pbCaption">').append('<label for="pbThumbsToggler" title="thumbnails on/off"></label>',j=e('<div class="pbCaptionText">').append('<div class="title"></div><div class="counter">'),_=e("<div>").addClass("pbThumbs")));e.fn.photobox=function(t,o,i){return this.each(function(){var s,a=e(this).data("_photobox");return a?("destroy"===t&&a.destroy(),this):("string"!=typeof t&&(t="a"),"prepareDOM"===t?(n(),this):(s=e.extend({},rt,o||{}),x=new C(s,this,t),e(this).data("_photobox",x),void(x.callback=i)))})},C=function(o,i,n){this.options=e.extend({},o),this.target=n,this.selector=e(i||t),this.thumbsList=null;var s=this.imageLinksFilter(this.selector.find(n));this.imageLinks=s[0],this.images=s[1],this.init()},C.prototype={init:function(){var e=this;this.selector.one("mouseenter.photobox",this.target,function(){e.thumbsList=E.generate.apply(e)}),this.selector.on("click.photobox",this.target,function(t){t.preventDefault(),e.open(this)}),this.observerTimeout=null,1==this.selector[0].nodeType&&this.observeDOM(this.selector[0],this.onDOMchanges.bind(this))},onDOMchanges:function(){var e=this;clearTimeout(this.observerTimeout),e.observerTimeout=setTimeout(function(){var t,o=e.imageLinksFilter(e.selector.find(e.target)),i=0,n=!1;if(e.imageLinks.length!=o[0].length){if(e.imageLinks=o[0],e.images=o[1],x&&e.selector==x.selector)for(Q=e.images,k=e.imageLinks,t=Q.length;t--;)Q[t][0]==L&&(n=!0);e.thumbsList=E.generate.apply(e),_.html(e.thumbsList),e.images.length&&L&&e.options.thumbs&&(i=e.thumbsList.find('a[href="'+L+'"]').eq(0).parent().index(),-1==i&&(i=0),E.changeActive(i,0))}},50)},open:function(t){var o=e.inArray(t,this.imageLinks);return-1==o?!1:(T=this.options,Q=this.images,k=this.imageLinks,x=this,this.setup(1),lt.on(G,function(){lt.off(G).addClass("on"),S(o,!0)}).addClass("show"),Z&&lt.trigger("MSTransitionEnd"),!1)},imageLinksFilter:function(t){var o,i=this,n=[],s={};return[t.filter(function(){var t,a=e(this),r="";return s.content=a[0].getAttribute("title")||"",i.options.thumb&&(t=a.find(i.options.thumb)[0]),i.options.thumb&&t||(t=a.find("img")[0]),t&&(o=t.getAttribute("data-pb-captionlink"),r=t.getAttribute(i.options.thumbAttr)||t.getAttribute("src"),s.content=t.getAttribute("alt")||t.getAttribute("title")||""),o&&(o=o.split("["),2==o.length?(s.linkText=o[0],s.linkHref=o[1].slice(0,-1)):(s.linkText=o,s.linkHref=o),s.content+=' <a href="'+s.linkHref+'">'+s.linkText+"</a>"),n.push([a[0].href,s.content,r]),!0}),n]},observeDOM:function(){var e=o.MutationObserver||o.WebKitMutationObserver,t=o.addEventListener;return function(o,i){if(e){var n=this,s=new e(function(e){(e[0].addedNodes.length||e[0].removedNodes.length)&&i(n)});s.observe(o,{childList:!0,subtree:!0})}else t&&(o.addEventListener("DOMNodeInserted",i.bind(n),!1),o.addEventListener("DOMNodeRemoved",i.bind(n),!1))}}(),setup:function(n){var a=n?"on":"off";X[0].src=et,T.thumbs&&(V||_[a]("mouseenter.photobox",E.calc)[a]("mousemove.photobox",E.move)),n?(X.css({transition:"0s"}).removeAttr("style"),lt.show(),_.html(this.thumbsList).trigger("mouseenter.photobox"),T.thumbs?lt.addClass("thumbs"):(R.prop("checked",!1),lt.removeClass("thumbs")),this.images.length<2||T.single?lt.removeClass("thumbs hasArrows hasCounter hasAutoplay"):(lt.addClass("hasArrows hasCounter"),T.time>1e3?(lt.addClass("hasAutoplay"),T.autoplay?P.progress.start():P.pause()):lt.removeClass("hasAutoplay")),T.hideFlash&&e("iframe, object, embed").css("visibility","hidden")):e(o).off("resize.photobox"),e(t).off("keydown.photobox")[a]({"keydown.photobox":r}),V&&(lt.removeClass("hasArrows"),U[a]("swipe",s)),T.zoomable&&(lt[a]({"mousewheel.photobox":g}),Z||_[a]({"mousewheel.photobox":b})),!T.single&&T.wheelNextPrev&&lt[a]({"mousewheel.photobox":i(l,1e3)})},destroy:function(){T=this.options,this.selector.off("click.photobox",this.target).removeData("_photobox"),A()}},E=function(){var t,o,i,n,s=0,a=0,r=0,l=0,u=null;return{generate:function(){var t,o,i,n,s,a=e("<ul>"),r=[],l=this.imageLinks.size();for(s=0;l>s;s++)i=this.imageLinks[s],o=this.images[s][2],o&&(t=this.images[s][1],n=i.rel?" class='"+i.rel+"'":"",r.push("<li"+n+'><a href="'+i.href+'"><img src="'+o+'" alt="" title="'+t+'" /></a></li>'));return a.html(r.join("")),a},click:function(t){t.preventDefault(),$.removeClass("active"),$=e(this).parent().addClass("active");var o=e(this.parentNode).index();return S(o,0,1)},changeActiveTimeout:null,changeActive:function(e,t,o){if(T.thumbs){{$.index()}$.removeClass("active"),$=_.find("li").eq(e).addClass("active"),!o&&$[0]&&(clearTimeout(this.changeActiveTimeout),this.changeActiveTimeout=setTimeout(function(){var e=$[0].offsetLeft+$[0].clientWidth/2-z.clientWidth/2;t?_.delay(800):_.stop(),_.animate({scrollLeft:e},500,"swing")},200))}},calc:function(e){return o=_[0],s=o.clientWidth,a=o.scrollWidth,t=.15*s,r=_.offset().left,l=e.pageX-t-r,n=l/(s-2*t),i=(a-s)*n,_.animate({scrollLeft:i},200),clearTimeout(u),u=setTimeout(function(){u=null},200),this},move:function(e){if(!u){var i,n,l=e.pageX-t-r;0>l&&(l=0),i=l/(s-2*t),n=(a-s)*i,it(function(){o.scrollLeft=n})}}}}(),P={autoPlayTimer:!1,play:function(){P.autoPlayTimer=setTimeout(function(){S(O)},T.time),P.progress.start(),W.removeClass("play"),P.setTitle("Click to stop autoplay"),T.autoplay=!0},pause:function(){clearTimeout(P.autoPlayTimer),P.progress.reset(),W.addClass("play"),P.setTitle("Click to resume autoplay"),T.autoplay=!1},progress:{reset:function(){W.find("div").removeAttr("style"),setTimeout(function(){W.removeClass("playing")},200)},start:function(){Z||W.find("div").css(ot,T.time+"ms"),W.addClass("playing")}},setTitle:function(e){e&&W.prop("title",e+" (every "+T.time/1e3+" seconds)")},toggle:function(e){e.stopPropagation(),P[T.autoplay?"pause":"play"]()}},S=function(){var e;return function(t,o,i){if(!e){if(e=setTimeout(function(){e=null},150),(!t||0>t)&&(t=0),T.loop||(N[t==Q.length-1?"addClass":"removeClass"]("pbHide"),I[0==t?"addClass":"removeClass"]("pbHide")),"function"==typeof T.beforeShow&&T.beforeShow(k[t]),lt.removeClass("error").addClass(t>K?"next":"prev"),c(t),y(),B.empty(),nt.onerror=null,X.add(B).data("zoom",1),H="video"==k[t].rel?"video":"image","video"==H)B.html(d()).addClass("pbHide"),m(o);else{var n=setTimeout(function(){lt.addClass("pbLoading")},50);Z&&lt.addClass("pbHide"),T.autoplay&&P.progress.reset(),nt=new Image,nt.onload=function(){nt.onload=null,D>=0&&(st.src=Q[D][0]),O>=0&&(at.src=Q[O][0]),clearTimeout(n),m(o)},nt.onerror=f,nt.src=L}j.on(G,p).addClass("change"),(o||Z)&&p(),E.changeActive(t,o,i),ut.save()}}}();var ut={save:function(){"pushState"in window.history&&decodeURIComponent(window.location.hash.slice(1))!=L&&T.history&&window.history.pushState("photobox",t.title+"-"+Q[K][1],window.location.pathname+window.location.search+"#"+encodeURIComponent(L))},load:function(){if(T&&!T.history)return!1;var t=decodeURIComponent(window.location.hash.slice(1));!t&&lt.hasClass("show")&&A(),e('a[href="'+t+'"]').trigger("click.photobox")},clear:function(){T.history&&"pushState"in window.history&&window.history.pushState("photobox",t.title,window.location.pathname+window.location.search)}};window.onpopstate=function(){var e=window.onpopstate;return function(t){e&&e.apply(this,arguments),"photobox"==t.state&&ut.load()}}(),e.event.special.swipe={setup:function(){e(this).bind("touchstart",e.event.special.swipe.handler)},teardown:function(){e(this).unbind("touchstart",e.event.special.swipe.handler)},handler:function(t){function o(){c.removeEventListener("touchmove",i),n=s=null}function i(i){i.preventDefault();var r=n-i.touches[0].pageX,h=s-i.touches[0].pageY;return Math.abs(r)>=20?(o(),l=r>0?-1:1):Math.abs(h)>=20&&(o(),u=h>0?1:-1),t.type="swipe",a.unshift(t,l,u),(e.event.dispatch||e.event.handle).apply(c,a)}var n,s,a=[].slice.call(arguments,1),r=t.originalEvent.touches,l=0,u=0,c=this;t=e.event.fix(t),1==r.length&&(n=r[0].pageX,s=r[0].pageY,this.addEventListener("touchmove",i,!1))}},!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var a=t||window.event,r=l.call(arguments,1),u=0,h=0,d=0,p=0,f=0,m=0;if(t=e.event.fix(a),t.type="mousewheel","detail"in a&&(d=-1*a.detail),"wheelDelta"in a&&(d=a.wheelDelta),"wheelDeltaY"in a&&(d=a.wheelDeltaY),"wheelDeltaX"in a&&(h=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(h=-1*d,d=0),u=0===d?h:d,"deltaY"in a&&(d=-1*a.deltaY,u=d),"deltaX"in a&&(h=a.deltaX,0===d&&(u=-1*h)),0!==d||0!==h){if(1===a.deltaMode){var v=e.data(this,"mousewheel-line-height");u*=v,d*=v,h*=v}else if(2===a.deltaMode){var g=e.data(this,"mousewheel-page-height");u*=g,d*=g,h*=g}if(p=Math.max(Math.abs(d),Math.abs(h)),(!s||s>p)&&(s=p,i(a,p)&&(s/=40)),i(a,p)&&(u/=40,h/=40,d/=40),u=Math[u>=1?"floor":"ceil"](u/s),h=Math[h>=1?"floor":"ceil"](h/s),d=Math[d>=1?"floor":"ceil"](d/s),c.settings.normalizeOffset&&this.getBoundingClientRect){var b=this.getBoundingClientRect();f=t.clientX-b.left,m=t.clientY-b.top}return t.deltaX=h,t.deltaY=d,t.deltaFactor=s,t.offsetX=f,t.offsetY=m,t.deltaMode=0,r.unshift(t,u,h,d),n&&clearTimeout(n),n=setTimeout(o,200),(e.event.dispatch||e.event.handle).apply(this,r)}}function o(){s=null}function i(e,t){return c.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var n,s,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var u=a.length;u;)e.event.fixHooks[a[--u]]=e.event.mouseHooks;var c=e.event.special.mousewheel={version:"3.1.11",setup:function(){if(this.addEventListener)for(var o=r.length;o;)this.addEventListener(r[--o],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",c.getLineHeight(this)),e.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var o=r.length;o;)this.removeEventListener(r[--o],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var o=e(t)["offsetParent"in e.fn?"offsetParent":"parent"]();return o.length||(o=e("body")),parseInt(o.css("fontSize"),10)},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),e(t).ready(n),window._photobox={DOM:{overlay:lt},close:A,history:ut,defaults:rt}}(jQuery,document,window);